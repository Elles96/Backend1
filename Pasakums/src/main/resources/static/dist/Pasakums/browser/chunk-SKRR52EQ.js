import{a as T,b as V,e as d,f as z}from"./chunk-JPQLGT5O.js";import{i as N}from"./chunk-OA6SNV5H.js";import{Ca as m,Da as c,Fa as g,Ga as k,H as y,Ha as I,Ia as U,Ja as D,Ka as i,La as s,M as f,Ma as l,Qa as F,R as M,Ra as _,S,Sa as p,Ta as o,Ua as v,Va as P,a as h,aa as u,b as C,ma as n,va as w}from"./chunk-WPM3UVLA.js";var x=class a{URL=z.apiUrl;http=f(N);getPasakumi(){return this.http.get(this.URL+"/pasakumi")}createPasakums(t){return this.http.post(this.URL+"/pasakumi",t)}static \u0275fac=function(e){return new(e||a)};static \u0275prov=y({token:a,factory:a.\u0275fac,providedIn:"root"})};var L=(a,t)=>t.id;function $(a,t){if(a&1&&(i(0,"div",13),o(1),s()),a&2){let e=p();n(),v(e.errorMsg())}}function A(a,t){if(a&1&&(i(0,"div",14),o(1),s()),a&2){let e=p();n(),v(e.successMsg())}}function R(a,t){a&1&&(i(0,"span",18),o(1,"Pilns"),s())}function B(a,t){a&1&&(i(0,"span",19),o(1,"Pieteikts"),s())}function J(a,t){if(a&1){let e=F();i(0,"li",16)(1,"strong"),o(2),s(),o(3),l(4,"br"),i(5,"span"),o(6),s(),l(7,"br"),i(8,"span"),o(9),s(),i(10,"p"),o(11),s(),i(12,"div",17),g(13,R,2,0,"span",18),g(14,B,2,0,"span",19),s(),i(15,"div",17)(16,"button",20),_("click",function(){let b=M(e).$implicit,E=p();return S(E.onSignUp(b.id))}),o(17," Pieteikties "),s(),i(18,"button",21),_("click",function(){let b=M(e).$implicit,E=p();return S(E.onCancel(b.id))}),o(19," Atcelt "),s()()()}if(a&2){let e=t.$implicit,r=p();n(2),v(e.nosaukums),n(),P(" - ",e.datums," ",e.laiks),n(3),v(e.vieta),n(3),P("Dal\u012Bbnieki: ",e.currentDalibnieki,"/",e.maxDalibnieki),n(2),v(e.apraksts),n(2),k(e.currentDalibnieki>=e.maxDalibnieki?13:-1),n(),k(r.signedUpEventIds().includes(e.id)?14:-1),n(2),D("disabled",e.currentDalibnieki>=e.maxDalibnieki||r.signedUpEventIds().includes(e.id)||!1),n(2),D("disabled",!r.signedUpEventIds().includes(e.id)||!1)}}var O=class a{pasakumi=u([]);pasakumsService=f(x);errorMsg=u("");successMsg=u("");signedUpEventIds=u([]);newEventSignal=u({id:0,nosaukums:"",apraksts:"",datums:"",laiks:"",vieta:"",maxDalibnieki:1,currentDalibnieki:0});eventForm=T(this.newEventSignal,t=>{d(t.nosaukums,{message:"Nosaukums ir oblig\u0101ts"}),d(t.apraksts,{message:"Apraksts ir oblig\u0101ts"}),d(t.datums,{message:"Datums ir oblig\u0101ts"}),d(t.laiks,{message:"Laiks ir oblig\u0101ts"}),d(t.vieta,{message:"Vieta ir oblig\u0101ta"}),d(t.maxDalibnieki,{message:"Maksim\u0101lais dal\u012Bbnieku skaits ir oblig\u0101ts"})});constructor(){this.pasakumsService.getPasakumi().subscribe(t=>{this.pasakumi.set(t)})}onSignUp(t){if(this.successMsg.set(""),this.errorMsg.set(""),this.signedUpEventIds().includes(t)){this.errorMsg.set("J\u016Bs jau esat pieteicies \u0161im pas\u0101kumam.");return}this.signedUpEventIds.set([...this.signedUpEventIds(),t]),this.pasakumi.set(this.pasakumi().map(e=>e.id===t?C(h({},e),{currentDalibnieki:e.currentDalibnieki+1}):e)),this.successMsg.set("Veiksm\u012Bgi pieteikts pas\u0101kumam!")}onCancel(t){if(this.successMsg.set(""),this.errorMsg.set(""),!this.signedUpEventIds().includes(t)){this.errorMsg.set("J\u016Bs neesat pieteicies \u0161im pas\u0101kumam.");return}this.signedUpEventIds.set(this.signedUpEventIds().filter(e=>e!==t)),this.pasakumi.set(this.pasakumi().map(e=>e.id===t?C(h({},e),{currentDalibnieki:e.currentDalibnieki-1}):e)),this.successMsg.set("Pieteikums veiksm\u012Bgi atcelts!")}onCreateEvent(){this.successMsg.set(""),this.errorMsg.set(""),this.pasakumsService.createPasakums(this.newEventSignal()).subscribe({next:t=>{this.pasakumi.set([...this.pasakumi(),t]),this.newEventSignal.set({id:0,nosaukums:"",apraksts:"",datums:"",laiks:"",vieta:"",maxDalibnieki:1,currentDalibnieki:0}),this.successMsg.set("Pas\u0101kums veiksm\u012Bgi izveidots!")},error:t=>{this.errorMsg.set("Neizdev\u0101s izveidot pas\u0101kumu."),console.error("Event creation failed:",t)}})}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=w({type:a,selectors:[["app-events"]],decls:26,vars:14,consts:[[1,"container","mt-5"],[1,"mb-4",3,"ngSubmit"],[1,"row","g-2"],[1,"col-md-4"],["type","text","placeholder","Nosaukums",1,"form-control",3,"field"],["type","text","placeholder","Apraksts",1,"form-control",3,"field"],[1,"col-md-2"],["type","date",1,"form-control",3,"field"],["type","time",1,"form-control",3,"field"],[1,"row","g-2","mt-2"],["type","text","placeholder","Vieta",1,"form-control",3,"field"],["type","number","placeholder","Max dal\u012Bbnieki",1,"form-control",3,"field"],["type","submit",1,"btn","btn-success"],[1,"alert","alert-danger"],[1,"alert","alert-success"],[1,"list-group"],[1,"list-group-item"],[1,"mt-2"],[1,"badge","bg-danger"],[1,"badge","bg-success"],[1,"btn","btn-primary","btn-sm",3,"click","disabled"],[1,"btn","btn-warning","btn-sm",3,"click","disabled"]],template:function(e,r){e&1&&(i(0,"div",0)(1,"h2"),o(2,"Pas\u0101kumi"),s(),i(3,"form",1),_("ngSubmit",function(){return r.onCreateEvent()}),i(4,"div",2)(5,"div",3),l(6,"input",4),m(),s(),i(7,"div",3),l(8,"input",5),m(),s(),i(9,"div",6),l(10,"input",7),m(),s(),i(11,"div",6),l(12,"input",8),m(),s()(),i(13,"div",9)(14,"div",3),l(15,"input",10),m(),s(),i(16,"div",6),l(17,"input",11),m(),s(),i(18,"div",6)(19,"button",12),o(20,"Izveidot pas\u0101kumu"),s()()()(),g(21,$,2,1,"div",13),g(22,A,2,1,"div",14),i(23,"ul",15),I(24,J,20,11,"li",16,L),s()()),e&2&&(n(6),c(r.eventForm.nosaukums),n(2),c(r.eventForm.apraksts),n(2),c(r.eventForm.datums),n(2),c(r.eventForm.laiks),n(3),c(r.eventForm.vieta),n(2),c(r.eventForm.maxDalibnieki),n(4),k(r.errorMsg()?21:-1),n(),k(r.successMsg()?22:-1),n(2),U(r.pasakumi()))},dependencies:[V],styles:["label[_ngcontent-%COMP%], input[type=text][_ngcontent-%COMP%]{width:100%;text-align:center}input[type=number].form-control[_ngcontent-%COMP%]{width:100%;text-align:center;appearance:textfield;-moz-appearance:textfield}input[type=number].form-control[_ngcontent-%COMP%]::-webkit-outer-spin-button, input[type=number].form-control[_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}strong[_ngcontent-%COMP%]{font-size:1.5em;color:red}"]})};export{O as Events};
